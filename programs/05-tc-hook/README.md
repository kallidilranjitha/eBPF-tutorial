This program parses packets and counts the number of IPv4, ICMP, UDP and TCP packets. Here, we attach/hook the program to ingress TC (traffic control) of the interface. We store the packet count in an eBPF map named “packet_counter_map”  at indexes 0, 1, 2, and 3 IPv4, ICMP, UDP and TCP, respectively. Here we access the map from the user space program and print the counter values on the console.
